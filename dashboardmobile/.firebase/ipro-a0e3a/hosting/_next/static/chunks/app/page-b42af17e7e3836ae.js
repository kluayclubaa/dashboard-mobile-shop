(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{9256:(e,s,t)=>{Promise.resolve().then(t.bind(t,9947))},9947:(e,s,t)=>{"use strict";let a;t.r(s),t.d(s,{default:()=>et});var r=t(5155),i=t(2115),n=t(3915),l=t(6203),d=t(5317);a=(0,n.Dk)().length?(0,n.Dk)()[0]:(0,n.Wp)({apiKey:"AIzaSyCHJCdKoWaOeM29Z8ubWWyULAXrvbTjb5s",authDomain:"ipro-a0e3a.firebaseapp.com",projectId:"ipro-a0e3a",storageBucket:"ipro-a0e3a.firebasestorage.app",messagingSenderId:"816977961038",appId:"1:816977961038:web:c2b1a6e7be95766462631f",measurementId:"G-GGBX7T7WGL"});let c=(0,d.aU)(a),o=(0,l.xI)(a);var x=t(9708),m=t(2085),u=t(2596),h=t(9688);function j(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,h.QP)((0,u.$)(s))}let p=(0,m.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function f(e){let{className:s,variant:t,size:a,asChild:i=!1,...n}=e,l=i?x.DX:"button";return(0,r.jsx)(l,{"data-slot":"button",className:j(p({variant:t,size:a,className:s})),...n})}function g(e){let{className:s,...t}=e;return(0,r.jsx)("div",{"data-slot":"card",className:j("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",s),...t})}function v(e){let{className:s,...t}=e;return(0,r.jsx)("div",{"data-slot":"card-header",className:j("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",s),...t})}function b(e){let{className:s,...t}=e;return(0,r.jsx)("div",{"data-slot":"card-title",className:j("leading-none font-semibold",s),...t})}function N(e){let{className:s,...t}=e;return(0,r.jsx)("div",{"data-slot":"card-description",className:j("text-muted-foreground text-sm",s),...t})}function y(e){let{className:s,...t}=e;return(0,r.jsx)("div",{"data-slot":"card-content",className:j("px-6",s),...t})}function w(e){let{className:s,type:t,...a}=e;return(0,r.jsx)("input",{type:t,"data-slot":"input",className:j("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",s),...a})}var k=t(968);function S(e){let{className:s,...t}=e;return(0,r.jsx)(k.b,{"data-slot":"label",className:j("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",s),...t})}let C=(0,m.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function A(e){let{className:s,variant:t,asChild:a=!1,...i}=e,n=a?x.DX:"span";return(0,r.jsx)(n,{"data-slot":"badge",className:j(C({variant:t}),s),...i})}var I=t(9713),q=t(4416);function _(e){let{...s}=e;return(0,r.jsx)(I.bL,{"data-slot":"dialog",...s})}function z(e){let{...s}=e;return(0,r.jsx)(I.l9,{"data-slot":"dialog-trigger",...s})}function D(e){let{...s}=e;return(0,r.jsx)(I.ZL,{"data-slot":"dialog-portal",...s})}function E(e){let{className:s,...t}=e;return(0,r.jsx)(I.hJ,{"data-slot":"dialog-overlay",className:j("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...t})}function J(e){let{className:s,children:t,showCloseButton:a=!0,...i}=e;return(0,r.jsxs)(D,{"data-slot":"dialog-portal",children:[(0,r.jsx)(E,{}),(0,r.jsxs)(I.UC,{"data-slot":"dialog-content",className:j("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...i,children:[t,a&&(0,r.jsxs)(I.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,r.jsx)(q.A,{}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function L(e){let{className:s,...t}=e;return(0,r.jsx)("div",{"data-slot":"dialog-header",className:j("flex flex-col gap-2 text-center sm:text-left",s),...t})}function F(e){let{className:s,...t}=e;return(0,r.jsx)(I.hE,{"data-slot":"dialog-title",className:j("text-lg leading-none font-semibold",s),...t})}function H(e){let{className:s,...t}=e;return(0,r.jsx)(I.VY,{"data-slot":"dialog-description",className:j("text-muted-foreground text-sm",s),...t})}var O=t(4439);function M(e){let{className:s,children:t,...a}=e;return(0,r.jsxs)(O.bL,{"data-slot":"scroll-area",className:j("relative",s),...a,children:[(0,r.jsx)(O.LM,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),(0,r.jsx)(P,{}),(0,r.jsx)(O.OK,{})]})}function P(e){let{className:s,orientation:t="vertical",...a}=e;return(0,r.jsx)(O.VM,{"data-slot":"scroll-area-scrollbar",orientation:t,className:j("flex touch-none p-px transition-colors select-none","vertical"===t&&"h-full w-2.5 border-l border-l-transparent","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent",s),...a,children:(0,r.jsx)(O.lr,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}let U=(0,m.F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function B(e){let{className:s,variant:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"alert",role:"alert",className:j(U({variant:t}),s),...a})}function Q(e){let{className:s,...t}=e;return(0,r.jsx)("div",{"data-slot":"alert-description",className:j("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",s),...t})}var K=t(8313),T=t(5339),V=t(4835),W=t(7550),G=t(4616),X=t(3109),Z=t(3227),R=t(7108),Y=t(2657),$=t(2713),ee=t(3717),es=t(2525);function et(){let[e,s]=(0,i.useState)(null),[t,a]=(0,i.useState)(""),[n,x]=(0,i.useState)(""),[m,u]=(0,i.useState)(!0),[h,j]=(0,i.useState)([]),[p,k]=(0,i.useState)([]),[C,I]=(0,i.useState)([]),[q,D]=(0,i.useState)("main"),[E,O]=(0,i.useState)(null),[P,U]=(0,i.useState)({type:null}),[et,en]=(0,i.useState)("");(0,i.useEffect)(()=>{let e=(0,l.hg)(o,e=>{s(e),u(!1)});return()=>e()},[]),(0,i.useEffect)(()=>{if(!e){j([]),k([]),I([]);return}let s=[(0,d.aQ)((0,d.rJ)(c,"branches"),e=>j(e.docs.map(e=>({id:e.id,...e.data()})))),(0,d.aQ)((0,d.rJ)(c,"stock"),e=>k(e.docs.map(e=>({id:e.id,...e.data()})))),(0,d.aQ)((0,d.P)((0,d.rJ)(c,"repairJobs"),(0,d.My)("createdAt","desc")),e=>I(e.docs.map(e=>({id:e.id,...e.data()}))))];return()=>s.forEach(e=>e())},[e]);let{totalRevenue:el,totalRepairs:ed,stockSummary:ec,selectedBranchStock:eo,selectedBranchJobs:ex}=(0,i.useMemo)(()=>{let e=C.reduce((e,s)=>e+(s.price||0),0),s=C.length,t=p.reduce((e,s)=>(e[s.name]=(e[s.name]||0)+s.quantity,e),{});return{totalRevenue:e,totalRepairs:s,stockSummary:t,selectedBranchStock:p.filter(e=>e.branchId===(null==E?void 0:E.id)),selectedBranchJobs:C.filter(e=>e.branchId===(null==E?void 0:E.id))}},[C,p,E]),em=async()=>{if("1234"===t){x(""),u(!0);try{await (0,l.zK)(o)}catch(e){console.error("Firebase Sign-In Error:",e),x("การเชื่อมต่อล้มเหลว กรุณาลองใหม่"),u(!1)}}else x("รหัสผ่านไม่ถูกต้อง")},eu=async()=>{await (0,l.CI)(o),D("main"),O(null)},eh=()=>{U({type:null}),en("")},ej=async e=>{e&&(await (0,d.gS)((0,d.rJ)(c,"branches"),{name:e}),eh())},ep=async(e,s,t)=>{e&&!(s<=0)&&E&&(t?await (0,d.mZ)((0,d.H9)(c,"stock",t),{quantity:s}):await (0,d.gS)((0,d.rJ)(c,"stock"),{branchId:E.id,name:e,quantity:Number.parseInt(s.toString(),10)}),eh())},ef=async e=>{e&&(await (0,d.kd)((0,d.H9)(c,"stock",e)),eh())},eg=async(e,s,t,a)=>{if(!E||!e)return en("กรุณากรอกข้อมูลให้ครบถ้วน");let r=new Map;null==a||a.itemsUsed.forEach(e=>r.set(e.stockId,e.quantity));let i=new Map;t.forEach(e=>i.set(e.stockId,e.quantity));let n=new Set([...r.keys(),...i.keys()]);try{await (0,d.c4)(c,async l=>{let o=await Promise.all(Array.from(n).map(async e=>{var s,t;let a=(0,d.H9)(c,"stock",e),n=await l.get(a);if(!n.exists())throw Error("ไม่พบสินค้า ID: ".concat(e));let o=n.data().quantity,x=null!=(s=r.get(e))?s:0,m=null!=(t=i.get(e))?t:0,u=x-m;if(u<0&&o<-u)throw Error("สินค้า '".concat(n.data().name,"' ไม่เพียงพอ"));return{ref:a,newQty:o+u}}));a?l.update((0,d.H9)(c,"repairJobs",a.id),{description:e,price:s,itemsUsed:t}):l.set((0,d.H9)((0,d.rJ)(c,"repairJobs")),{branchId:E.id,description:e,price:s,itemsUsed:t,createdAt:new Date().toISOString()}),o.forEach(e=>{let{ref:s,newQty:t}=e;return l.update(s,{quantity:t})})}),eh()}catch(e){console.error("Transaction failed:",e),en(e.message)}},ev=async e=>{if(e)try{await (0,d.c4)(c,async s=>{let t=e.itemsUsed.map(async e=>{let t=(0,d.H9)(c,"stock",e.stockId),a=await s.get(t);return a.exists()?{ref:t,newQuantity:a.data().quantity+e.quantity}:(console.warn("Stock item ".concat(e.name," (ID: ").concat(e.stockId,") not found for restoration.")),null)}),a=(await Promise.all(t)).filter(Boolean),r=(0,d.H9)(c,"repairJobs",e.id);s.delete(r),a.forEach(e=>{e&&s.update(e.ref,{quantity:e.newQuantity})})}),eh()}catch(e){console.error("Delete transaction failed:",e),en(e.message)}};return m?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsxs)("div",{className:"text-center space-y-4",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"กำลังโหลด..."})]})}):e?(0,r.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,r.jsx)("header",{className:"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,r.jsxs)("div",{className:"container flex h-16 items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-primary rounded-lg flex items-center justify-center",children:(0,r.jsx)(K.A,{className:"w-4 h-4 text-primary-foreground"})}),(0,r.jsx)("h1",{className:"text-xl font-bold",children:"I-PRO Dashboard"})]}),(0,r.jsxs)(f,{variant:"outline",onClick:eu,children:[(0,r.jsx)(V.A,{className:"w-4 h-4 mr-2"}),"ออกจากระบบ"]})]})}),(0,r.jsxs)("main",{className:"container py-6",children:["main"!==q&&(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsxs)(f,{variant:"ghost",onClick:()=>{"stock_management"===q?D("branch_details"):D("main")},className:"mb-4",children:[(0,r.jsx)(W.A,{className:"w-4 h-4 mr-2"}),"stock_management"===q?"กลับไปหน้ารายละเอียดสาขา":"กลับไปหน้าหลัก"]})}),"main"===q&&(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"ภาพรวมทั้งหมด"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"จัดการร้านซ่อมมือถือของคุณ"})]}),(0,r.jsxs)(_,{children:[(0,r.jsx)(z,{asChild:!0,children:(0,r.jsxs)(f,{children:[(0,r.jsx)(G.A,{className:"w-4 h-4 mr-2"}),"เพิ่มสาขาใหม่"]})}),(0,r.jsxs)(J,{children:[(0,r.jsxs)(L,{children:[(0,r.jsx)(F,{children:"เพิ่มสาขาใหม่"}),(0,r.jsx)(H,{children:"กรอกชื่อสาขาที่ต้องการเพิ่ม"})]}),(0,r.jsx)(ea,{onSubmit:ej,onClose:eh})]})]})]}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,r.jsxs)(g,{children:[(0,r.jsxs)(v,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(b,{className:"text-sm font-medium",children:"รายได้รวม"}),(0,r.jsx)(X.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(y,{children:[(0,r.jsxs)("div",{className:"text-2xl font-bold",children:["฿",el.toLocaleString()]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"จากงานซ่อมทั้งหมด"})]})]}),(0,r.jsxs)(g,{children:[(0,r.jsxs)(v,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(b,{className:"text-sm font-medium",children:"จำนวนงานซ่อม"}),(0,r.jsx)(K.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(y,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:ed.toLocaleString()}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"งานที่เสร็จสิ้นแล้ว"})]})]}),(0,r.jsxs)(g,{children:[(0,r.jsxs)(v,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(b,{className:"text-sm font-medium",children:"จำนวนสาขา"}),(0,r.jsx)(Z.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(y,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:h.length}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"สาขาที่เปิดให้บริการ"})]})]}),(0,r.jsxs)(g,{children:[(0,r.jsxs)(v,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(b,{className:"text-sm font-medium",children:"รายการสต็อก"}),(0,r.jsx)(R.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(y,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:Object.keys(ec).length}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"ประเภทสินค้าทั้งหมด"})]})]})]}),(0,r.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,r.jsxs)(g,{children:[(0,r.jsxs)(v,{children:[(0,r.jsxs)(b,{className:"flex items-center gap-2",children:[(0,r.jsx)(Z.A,{className:"w-5 h-5"}),"สาขาทั้งหมด"]}),(0,r.jsx)(N,{children:"คลิกที่สาขาเพื่อดูรายละเอียดและจัดการ"})]}),(0,r.jsx)(y,{children:h.length>0?(0,r.jsx)("div",{className:"grid gap-3",children:h.map(e=>(0,r.jsx)(g,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>{O(e),D("branch_details")},children:(0,r.jsx)(y,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold",children:e.name}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["งานซ่อม: ",C.filter(s=>s.branchId===e.id).length," รายการ"]})]}),(0,r.jsx)(Y.A,{className:"w-4 h-4 text-muted-foreground"})]})})},e.id))}):(0,r.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,r.jsx)(Z.A,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),(0,r.jsx)("p",{children:"ยังไม่มีสาขา"}),(0,r.jsx)("p",{className:"text-sm",children:'คลิก "เพิ่มสาขาใหม่" เพื่อเริ่มต้น'})]})})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)(g,{children:[(0,r.jsx)(v,{children:(0,r.jsxs)(b,{className:"flex items-center gap-2",children:[(0,r.jsx)($.A,{className:"w-5 h-5"}),"รายการซ่อมล่าสุด"]})}),(0,r.jsx)(y,{children:(0,r.jsx)(M,{className:"h-48",children:C.length>0?(0,r.jsx)("div",{className:"space-y-3",children:C.slice(0,5).map(e=>{var s,t;return(0,r.jsxs)("div",{className:"flex justify-between items-start p-3 rounded-lg bg-muted/50",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("p",{className:"font-medium text-sm",children:e.description}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["สาขา: ",(null==(s=h.find(s=>s.id===e.branchId))?void 0:s.name)||"N/A"]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:new Date(e.createdAt).toLocaleDateString("th-TH")})]}),(0,r.jsxs)(A,{variant:"secondary",children:["฿",(null==(t=e.price)?void 0:t.toLocaleString())||0]})]},e.id)})}):(0,r.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,r.jsx)(K.A,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,r.jsx)("p",{className:"text-sm",children:"ยังไม่มีรายการซ่อม"})]})})})]}),(0,r.jsxs)(g,{children:[(0,r.jsx)(v,{children:(0,r.jsxs)(b,{className:"flex items-center gap-2",children:[(0,r.jsx)(R.A,{className:"w-5 h-5"}),"สรุปสต็อกคงคลัง"]})}),(0,r.jsx)(y,{children:(0,r.jsx)(M,{className:"h-48",children:Object.keys(ec).length>0?(0,r.jsx)("div",{className:"space-y-2",children:Object.entries(ec).map(e=>{let[s,t]=e;return(0,r.jsxs)("div",{className:"flex justify-between items-center p-2 rounded bg-muted/30",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:s}),(0,r.jsxs)(A,{variant:t>10?"default":t>5?"secondary":"destructive",children:[t," ชิ้น"]})]},s)})}):(0,r.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,r.jsx)(R.A,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,r.jsx)("p",{className:"text-sm",children:"ไม่มีสินค้าในสต็อก"})]})})})]})]})]})]}),"branch_details"===q&&E&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:E.name}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"จัดการงานซ่อมและสต็อกสินค้า"})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)(_,{children:[(0,r.jsx)(z,{asChild:!0,children:(0,r.jsxs)(f,{children:[(0,r.jsx)(K.A,{className:"w-4 h-4 mr-2"}),"เพิ่มรายการซ่อม"]})}),(0,r.jsxs)(J,{className:"max-w-2xl",children:[(0,r.jsxs)(L,{children:[(0,r.jsx)(F,{children:"เพิ่มรายการซ่อม"}),(0,r.jsx)(H,{children:"กรอกรายละเอียดงานซ่อมและเลือกอุปกรณ์ที่ใช้"})]}),(0,r.jsx)(ei,{selectedBranchStock:eo,onSubmit:eg,onClose:eh,error:et})]})]}),(0,r.jsxs)(f,{variant:"outline",onClick:()=>D("stock_management"),children:[(0,r.jsx)(R.A,{className:"w-4 h-4 mr-2"}),"จัดการสต็อก"]})]})]}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,r.jsxs)(g,{children:[(0,r.jsx)(v,{className:"pb-2",children:(0,r.jsx)(b,{className:"text-sm font-medium",children:"รายได้สาขานี้"})}),(0,r.jsx)(y,{children:(0,r.jsxs)("div",{className:"text-2xl font-bold",children:["฿",ex.reduce((e,s)=>e+(s.price||0),0).toLocaleString()]})})]}),(0,r.jsxs)(g,{children:[(0,r.jsx)(v,{className:"pb-2",children:(0,r.jsx)(b,{className:"text-sm font-medium",children:"งานซ่อมทั้งหมด"})}),(0,r.jsx)(y,{children:(0,r.jsx)("div",{className:"text-2xl font-bold",children:ex.length})})]}),(0,r.jsxs)(g,{children:[(0,r.jsx)(v,{className:"pb-2",children:(0,r.jsx)(b,{className:"text-sm font-medium",children:"รายการสต็อก"})}),(0,r.jsx)(y,{children:(0,r.jsx)("div",{className:"text-2xl font-bold",children:eo.length})})]})]}),(0,r.jsxs)(g,{children:[(0,r.jsxs)(v,{children:[(0,r.jsx)(b,{children:"รายการซ่อม"}),(0,r.jsx)(N,{children:"งานซ่อมทั้งหมดของสาขานี้"})]}),(0,r.jsx)(y,{children:ex.length>0?(0,r.jsx)("div",{className:"space-y-4",children:ex.map(e=>{var s;return(0,r.jsx)(g,{children:(0,r.jsx)(y,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("h4",{className:"font-semibold",children:e.description}),(0,r.jsxs)(A,{variant:"secondary",children:["฿",(null==(s=e.price)?void 0:s.toLocaleString())||0]})]}),e.itemsUsed.length>0&&(0,r.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,r.jsx)("span",{className:"font-medium",children:"อุปกรณ์ที่ใช้: "}),e.itemsUsed.map((s,t)=>(0,r.jsxs)("span",{children:[s.name," (",s.quantity," ชิ้น)",t<e.itemsUsed.length-1&&", "]},s.stockId))]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:new Date(e.createdAt).toLocaleString("th-TH")})]}),(0,r.jsxs)("div",{className:"flex gap-1",children:[(0,r.jsxs)(_,{children:[(0,r.jsx)(z,{asChild:!0,children:(0,r.jsx)(f,{variant:"ghost",size:"sm",children:(0,r.jsx)(ee.A,{className:"w-4 h-4"})})}),(0,r.jsxs)(J,{className:"max-w-2xl",children:[(0,r.jsx)(L,{children:(0,r.jsx)(F,{children:"แก้ไขรายการซ่อม"})}),(0,r.jsx)(ei,{selectedBranchStock:eo,onSubmit:eg,onClose:eh,error:et,initialData:e})]})]}),(0,r.jsxs)(_,{children:[(0,r.jsx)(z,{asChild:!0,children:(0,r.jsx)(f,{variant:"ghost",size:"sm",children:(0,r.jsx)(es.A,{className:"w-4 h-4 text-destructive"})})}),(0,r.jsxs)(J,{children:[(0,r.jsxs)(L,{children:[(0,r.jsx)(F,{children:"ยืนยันการลบ"}),(0,r.jsxs)(H,{children:['คุณแน่ใจหรือไม่ว่าต้องการลบรายการซ่อม "',e.description,'"? การกระทำนี้จะคืนสต็อกสินค้าที่ใช้ไปกลับเข้าระบบ']})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)(z,{asChild:!0,children:(0,r.jsx)(f,{variant:"outline",children:"ยกเลิก"})}),(0,r.jsx)(f,{variant:"destructive",onClick:()=>ev(e),children:"ยืนยันการลบ"})]})]})]})]})]})})},e.id)})}):(0,r.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,r.jsx)(K.A,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),(0,r.jsx)("p",{children:"ยังไม่มีรายการซ่อม"}),(0,r.jsx)("p",{className:"text-sm",children:'คลิก "เพิ่มรายการซ่อม" เพื่อเริ่มต้น'})]})})]})]}),"stock_management"===q&&E&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-3xl font-bold tracking-tight",children:["จัดการสต็อก: ",E.name]}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"เพิ่ม แก้ไข และจัดการสินค้าคงคลัง"})]}),(0,r.jsxs)(_,{children:[(0,r.jsx)(z,{asChild:!0,children:(0,r.jsxs)(f,{children:[(0,r.jsx)(G.A,{className:"w-4 h-4 mr-2"}),"เพิ่มสินค้าเข้าสต็อก"]})}),(0,r.jsxs)(J,{children:[(0,r.jsxs)(L,{children:[(0,r.jsx)(F,{children:"เพิ่มสินค้าเข้าสต็อก"}),(0,r.jsx)(H,{children:"กรอกรายละเอียดสินค้าที่ต้องการเพิ่ม"})]}),(0,r.jsx)(er,{onSubmit:ep,onClose:eh})]})]})]}),(0,r.jsxs)(g,{children:[(0,r.jsxs)(v,{children:[(0,r.jsx)(b,{children:"รายการสต็อกสินค้า"}),(0,r.jsx)(N,{children:"สินค้าคงคลังทั้งหมดของสาขานี้"})]}),(0,r.jsx)(y,{children:eo.length>0?(0,r.jsx)("div",{className:"space-y-4",children:eo.map(e=>(0,r.jsx)(g,{children:(0,r.jsx)(y,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold",children:e.name}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["จำนวนคงเหลือ: ",e.quantity," ชิ้น"]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(A,{variant:e.quantity>10?"default":e.quantity>5?"secondary":"destructive",children:[e.quantity," ชิ้น"]}),(0,r.jsxs)("div",{className:"flex gap-1",children:[(0,r.jsxs)(_,{children:[(0,r.jsx)(z,{asChild:!0,children:(0,r.jsx)(f,{variant:"ghost",size:"sm",children:(0,r.jsx)(ee.A,{className:"w-4 h-4"})})}),(0,r.jsxs)(J,{children:[(0,r.jsx)(L,{children:(0,r.jsxs)(F,{children:["แก้ไขสต็อก: ",e.name]})}),(0,r.jsx)(er,{onSubmit:ep,onClose:eh,initialData:e})]})]}),(0,r.jsxs)(_,{children:[(0,r.jsx)(z,{asChild:!0,children:(0,r.jsx)(f,{variant:"ghost",size:"sm",children:(0,r.jsx)(es.A,{className:"w-4 h-4 text-destructive"})})}),(0,r.jsxs)(J,{children:[(0,r.jsxs)(L,{children:[(0,r.jsx)(F,{children:"ยืนยันการลบ"}),(0,r.jsxs)(H,{children:['คุณแน่ใจหรือไม่ว่าต้องการลบสินค้า "',e.name,'"? การกระทำนี้ไม่สามารถย้อนกลับได้']})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)(z,{asChild:!0,children:(0,r.jsx)(f,{variant:"outline",children:"ยกเลิก"})}),(0,r.jsx)(f,{variant:"destructive",onClick:()=>ef(e.id),children:"ยืนยันการลบ"})]})]})]})]})]})]})})},e.id))}):(0,r.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,r.jsx)(R.A,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),(0,r.jsx)("p",{children:"ยังไม่มีสินค้าในสต็อก"}),(0,r.jsx)("p",{className:"text-sm",children:'คลิก "เพิ่มสินค้าเข้าสต็อก" เพื่อเริ่มต้น'})]})})]})]})]})]}):(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800",children:(0,r.jsxs)(g,{className:"w-full max-w-md mx-4",children:[(0,r.jsxs)(v,{className:"text-center space-y-2",children:[(0,r.jsx)("div",{className:"mx-auto w-12 h-12 bg-primary rounded-full flex items-center justify-center",children:(0,r.jsx)(K.A,{className:"w-6 h-6 text-primary-foreground"})}),(0,r.jsx)(b,{className:"text-2xl",children:"I-PRO Dashboard"}),(0,r.jsx)(N,{children:"ระบบจัดการร้านซ่อมมือถือ"})]}),(0,r.jsxs)(y,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(S,{htmlFor:"password",children:"รหัสผ่าน"}),(0,r.jsx)(w,{id:"password",type:"password",value:t,onChange:e=>a(e.target.value),onKeyPress:e=>"Enter"===e.key&&em(),placeholder:"กรุณาใส่รหัสผ่าน"})]}),n&&(0,r.jsxs)(B,{variant:"destructive",children:[(0,r.jsx)(T.A,{className:"h-4 w-4"}),(0,r.jsx)(Q,{children:n})]}),(0,r.jsx)(f,{onClick:em,className:"w-full",children:"เข้าสู่ระบบ"})]})]})})}let ea=e=>{let{onSubmit:s,onClose:t}=e,[a,n]=(0,i.useState)("");return(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),a.trim()&&(s(a.trim()),n(""))},className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(S,{htmlFor:"branch-name",children:"ชื่อสาขา"}),(0,r.jsx)(w,{id:"branch-name",value:a,onChange:e=>n(e.target.value),placeholder:"กรอกชื่อสาขา",required:!0})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)(f,{type:"button",variant:"outline",onClick:t,children:"ยกเลิก"}),(0,r.jsx)(f,{type:"submit",children:"บันทึก"})]})]})},er=e=>{let{onSubmit:s,onClose:t,initialData:a}=e,[n,l]=(0,i.useState)((null==a?void 0:a.name)||""),[d,c]=(0,i.useState)((null==a?void 0:a.quantity)||1);return(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),n.trim()&&d>0&&(s(n.trim(),d,null==a?void 0:a.id),a||(l(""),c(1)))},className:"space-y-4",children:[!a&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(S,{htmlFor:"stock-name",children:"ชื่อสินค้า"}),(0,r.jsx)(w,{id:"stock-name",value:n,onChange:e=>l(e.target.value),placeholder:"กรอกชื่อสินค้า",required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(S,{htmlFor:"stock-quantity",children:"จำนวน"}),(0,r.jsx)(w,{id:"stock-quantity",type:"number",value:d,onChange:e=>c(Number(e.target.value)),placeholder:"กรอกจำนวน",min:"1",required:!0})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)(f,{type:"button",variant:"outline",onClick:t,children:"ยกเลิก"}),(0,r.jsx)(f,{type:"submit",children:"บันทึก"})]})]})},ei=e=>{let{selectedBranchStock:s,onSubmit:t,onClose:a,error:n,initialData:l}=e,[d,c]=(0,i.useState)((null==l?void 0:l.description)||""),[o,x]=(0,i.useState)((null==l?void 0:l.price)||0),[m,u]=(0,i.useState)((null==l?void 0:l.itemsUsed)||[]),h=(e,s)=>{let t=Math.max(0,Math.min(s,e.quantity));u(s=>0===t?s.filter(s=>s.stockId!==e.id):[...s.filter(s=>s.stockId!==e.id),{stockId:e.id,name:e.name,quantity:t}])};return(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),d.trim()&&o>=0&&t(d.trim(),o,m,l)},className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(S,{htmlFor:"repair-description",children:"รายละเอียดงานซ่อม"}),(0,r.jsx)(w,{id:"repair-description",value:d,onChange:e=>c(e.target.value),placeholder:"เช่น เปลี่ยนหน้าจอ iPhone 12",required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(S,{htmlFor:"repair-price",children:"ราคาซ่อม (บาท)"}),(0,r.jsx)(w,{id:"repair-price",type:"number",value:o,onChange:e=>x(Number(e.target.value)),placeholder:"0",min:"0",required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(S,{children:"อุปกรณ์ที่ใช้"}),(0,r.jsx)(M,{className:"h-48 border rounded-md p-3",children:s.length>0?(0,r.jsx)("div",{className:"space-y-3",children:s.map(e=>{let s=m.find(s=>s.stockId===e.id),t=e.quantity+((null==s?void 0:s.quantity)||0);return(0,r.jsxs)("div",{className:"flex items-center justify-between p-2 rounded bg-muted/50",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-sm",children:e.name}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["มี ",t," ชิ้น"]})]}),(0,r.jsx)("div",{className:"w-20",children:(0,r.jsx)(w,{type:"number",min:0,max:t,value:(null==s?void 0:s.quantity)||0,onChange:s=>h(e,Number(s.target.value)),className:"text-center"})})]},e.id)})}):(0,r.jsx)("p",{className:"text-center text-muted-foreground py-4",children:"ไม่มีสินค้าในสต็อก"})})]}),n&&(0,r.jsxs)(B,{variant:"destructive",children:[(0,r.jsx)(T.A,{className:"h-4 w-4"}),(0,r.jsx)(Q,{children:n})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)(f,{type:"button",variant:"outline",onClick:a,children:"ยกเลิก"}),(0,r.jsx)(f,{type:"submit",children:"บันทึก"})]})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[992,163,957,441,684,358],()=>s(9256)),_N_E=e.O()}]);